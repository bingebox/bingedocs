# Jeff Bezos的命令
2011年Steve Yegge， Amazon的前员工，现任Google员工在Google+上写了一篇调侃恶搞的文章，其中谈到Amazon如何进化成一个平台性的公司，很值得我们今天思考。  
据说2002年Jeff Bezos给全公司下了一个法令：    
    1) 所有团队的程序模块都要以通过Service Interface方式将其数据与功能开放出来。  
    2) 团队间的程序模块的信息通信，都要通过这些接口。  
    3) 除此之外没有其它的通信方式。其他形式一概不允许：不能使用直接链结程序、不能直接读取其他团队的数据库、不能使用共享内存模式、不能使用别人模块的后门、等等，等等，唯一允许的通信方式只能是能过调用 Service Interface。  
    4) 任何技术都可以使用。比如：HTTP、Corba、Pubsub、自定义的网络协议、等等，都可以，Bezos不管这些。  
    5) 所有的Service Interface，毫无例外，都必须从骨子里到表面上设计成能对外界开放的。也就是说，团队必须做好规划与设计，以便未来把接口开放给全世界的程序员，没有任何例外。  
    6) 不这样的做的人会被炒鱿鱼。     
   
我们今天讨论云原生应用，讨论微服务，有没有想过这些东西是怎么演化而来的，哪些企业首先做了开创性的尝试，技术是怎样一步步变成今天这个样子的，这种对技术历史的了解有助于我们更好地理解今天这些先进的技术和架构。  
    从Steve Yegge透露的信息来看，Amazon在2002年前后实施了平台服务化，平台架构走向面向服务架构SOA，之后几年里获得了很多工程经验.   
    1) pager escalation（生产线上问题的寻呼系统）变得比较困难，因为ticket可能会转过来转过去（ticket就是处理问题的工单），只到转了20次，都找到真正能解决问题的团队和人。如果每一个呼叫都花去团队的15分钟的响应时间，那在找到真正的团队之前，几小时就已经过去了，除非，你能建造出很多很多的脚手架，测量标准和报告。  
    2) 每一个和你的相关团队突然间都可能成为一个潜在性的DOS攻击者。没人可以让事情有进展，直到在每一个Service里放上配额（quota）与节流阀（throttling）的机制。  
    3) 监控与QA是被统一了。如果你不进行一个大规模的SOA，你就不会这么去想。但是，等到你的Service说，“是的，我还好！”，但实际情况可能是，服务器里唯一能正常运作的功能就是一个快乐的机器声音在呼叫你：“我很好，收到，收到”。为了要确认整个服务能正常运作，你需要对Service的每一个部分都去Call一下。这个问题会以递归的形式地出现，直到你的监控系统能够全面性地系统地检查所有的Services和数据，此时，监控系统就跟自动化测试QA没什么两样了，所以两者完美的统一了。  
    4) 如果你有上百个Services，而且你的程序只能通过由这些Services来跟其他团队的程序做沟通，那么，没有一套Service发现机制的话，你就不能找到这些Service。所以，你得先有一套Service的注册机制，这也是一个Service。所以，Amazon有一套全体适用的Service注册机制，以例可以通过反射机制来找到Service，并知道Service的API，以及是否可用，在哪儿。  
    5) 调试其他人的代码以调查问题变得非常的难，几乎都不可能，除非有一套全面性的标准的方式，他可以在可被调试的沙盒里运行所有的Services。  
   
经过三年左右的努力，Amazon已经把文化转变成了“一切以Service第一”为系统架构的公司，这已经成为他们进行所有设计时的基础，包括那些绝不会被外界所知的仅在内部使用的功能。   
    SOA驱动出来的设计会产生出平台（Platform）, 这就是Bezos的法令要达成的目标。他一点不关心各团队是否好，也不关心他们使用什么样的技术，实际也不去管他们如何运作他们的业务，除非团队开始把事搞砸。但是，Bezos比绝大多数的亚马逊人都很早很早就领悟到，Amazon必须成为一个平台。  
    接着作者提问：“如果是你，你会想到要把一个在线卖书的网站设计成为一个有扩展性，可程序化的平台？你真的会这样想吗？”  
    他认为Bezos领悟到的第一件大事是：为了销售书籍和各种商品需要的基础架构，可以被转变成为绝佳计算平台。  
    而Bezos领悟到的第二件大事是: Accessibility。作者认为Accessibility是计算机世界中最最重要的事情了，因为如果一个软件不能被存取或使用，那这个软件就是没用的东西，而且他认为Accessibility要比安全性来的重要多了，因为零Accessibility就意为着你根本没有做出产品来，而如果安全性为零，你仍然还是可以有一个某个程度上成功的产品。  
    没有平台的产品是没用的，再精确一点，去平台化的产品总是被平台化的产品所取代。  
    平台的黄金守则，“Eat Your Own Dogfood 吃自己的狗食”，换句话说，“先打造出自己使用平台，然后把它用在所有的地方”。你不能事后再做，那样做就太困难了。  
    所以，服务、平台、生态、产品之间的关系，是作者提醒我们要重点关注的，是Amazon做得很牛逼的地方。  
